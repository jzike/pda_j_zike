---
title: "R Notebook"
output: html_notebook
---

## Libraries
```{r}
library(tidyverse)
library(tsibbledata)
library(lubridate)
library(tsibble)
```
# Documentation




## Questions

- What is the pattern of bike hires over time (e.g. within a year, month, week, or day)?

- Do bike hire patterns differ between bike rider demographics? (e.g. gender, type of trip, age)?

- What is the geographical spread of the start points of bike hires?

- Optional: Can you predict bike use over the next couple of months? (This is based on the flipped time series forecasting lesson)

- Any other insights?

## Problems discovered

- Some very large values in use_duration_mins representing use over multiple days


```{r}
bikes_data <- nyc_bikes

bikes_data %>% head()
```

```{r}
bikes_data %>% 
  index_by(start_month) %>% 
  summarise(count = n())
```








```{r}
#create variables for date, month, year from start_time
bikes_data <- bikes_data %>% 
  mutate(start_date = date(start_time),
         start_month = month(start_time, label = TRUE),
         start_year = year(start_time), .after = start_time)
```

```{r}
#create variable for use duration in minutes
bikes_data <- bikes_data %>% 
  mutate(use_period = as.period(stop_time - start_time),
         use_duration_mins = as.numeric(use_period, "minutes"))
```

```{r}
bikes_data %>% 
  slice_max(use_duration_mins, n = 10)
```


```{r}
bikes_data %>% 
  ggplot(aes(x = use_duration_mins, 
             y = gender)) +
  geom_boxplot(outlier.colour = "red") +
  geom_jitter() +
  scale_x_log10()
```

```{r}
bikes_data %>% 
  ggplot(aes(x = use_duration_mins)) +
  geom_histogram(col = "white") +
  facet_wrap(~gender) +
  scale_x_continuous("log10")
```

